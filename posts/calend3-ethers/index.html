<!DOCTYPE html>
<html><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="hacking the markets: financial programming tutorials by parttimelarry">
    
    <link rel="shortcut icon" href="https://hackingthemarkets.github.io/favicon.ico">
    
    <link rel="stylesheet" href="/css/style.min.css">

    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XCGL4SLHHN"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-XCGL4SLHHN', { 'anonymize_ip': false });
}
</script>


    <title>web3 tutorial [09/10] - ethers.js: calling smart contracts from the web</title>
</head>
<body><header id="banner">
    <h2><a href="https://hackingthemarkets.github.io">hacking the markets</a></h2>
    <nav>
        <ul>
            <li>
                <a href="/" title="posts">posts</a>
            </li><li>
                <a href="https://youtube.com/parttimelarry" title="youtube">youtube</a>
            </li><li>
                <a href="https://twitter.com/parttimelarry" title="twitter">twitter</a>
            </li><li>
                <a href="https://github.com/hackingthemarkets" title="github">github</a>
            </li>
        </ul>
    </nav>
</header>
<main id="content">
<article>
    <header id="post-header">
        <h1>web3 tutorial [09/10] - ethers.js: calling smart contracts from the web</h1>
            <div>
                <time>February 27, 2022</time>
                
                <span>
                    
                        by parttimelarry
                    
                </span></div>
    </header><br />

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/2l1QKsgAy7Y" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<aside id="toc">
    <h4>Table of Contents</h4>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#putting-it-all-together">Putting it all together</a></li>
    <li><a href="#what-is-ethersjs">What is Ethers.js?</a></li>
    <li><a href="#calling-your-backend-abis-vs-apis">Calling Your Backend: ABI&rsquo;s vs. API&rsquo;s</a></li>
    <li><a href="#using-ethersjs">Using Ethers.js</a>
      <ul>
        <li><a href="#creating-an-etherjs-contract-object">Creating an ether.js Contract object</a></li>
      </ul>
    </li>
    <li><a href="#admin-user-and-setting-a-rate">Admin User and Setting a Rate</a>
      <ul>
        <li><a href="#admin-ui-state-variables">Admin UI State Variables</a>
          <ul>
            <li><a href="#isadmin-and-setisadmin">isAdmin and setIsAdmin()</a></li>
          </ul>
        </li>
        <li><a href="#making-mistakes-and-fixing-them">Making Mistakes and Fixing Them</a></li>
        <li><a href="#admin-ui-slider-component">Admin UI Slider Component</a>
          <ul>
            <li><a href="#additional-styling">Additional Styling</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#fetching-appointments">Fetching Appointments</a>
      <ul>
        <li><a href="#transforming-appointment-data">Transforming Appointment Data</a></li>
        <li><a href="#creating-an-appointment">Creating an Appointment</a></li>
        <li><a href="#create-appointment">Create Appointment</a></li>
      </ul>
    </li>
    <li><a href="#dialogs-and-progress-indicators">Dialogs and Progress Indicators</a></li>
  </ul>
</nav>
</aside>

<h1 id="putting-it-all-together">Putting it all together</h1>
<p>So we&rsquo;ve written a smart contract in Solidity and deployed it to the Goerli testnet using Alchemy. We&rsquo;ve also created an appointment scheduling interface with React and Material-UI. Currently our frontend and backend are completely disconnected. Let&rsquo;s change that. We want our UI to <strong>read data from</strong> and <strong>write data to the blockchain</strong> by calling our smart contract. To do this, we will be using Ethers.js.</p>
<h1 id="what-is-ethersjs">What is Ethers.js?</h1>
<p><a href="https://docs.ethers.io/v5/">Ethers.js</a> is a JavaScript library for interacting with the Ethereum blockchain. For our purposes, we will be using the ethers.js <a href="https://docs.ethers.io/v5/getting-started/#getting-started--contracts">Contract object</a>. The Contract object will allow us call our smart contract using JavaScript.</p>
<h1 id="calling-your-backend-abis-vs-apis">Calling Your Backend: ABI&rsquo;s vs. API&rsquo;s</h1>
<p>When developing a &ldquo;traditional&rdquo; web application, we often fetch data from a <strong>REST API</strong>. We make an HTTP request and get an HTTP response, often in JSON format. In an Ethereum dapp, we will call our smart contract using an <em><strong>ABI</strong></em>.  <strong>ABI</strong> stands for <strong>Application Binary Interface</strong>.</p>
<p>When you compile your Solidity code, it generates an ABI file in the artifacts/ directory. It should look similar to the one below. As you can see, our ABI is a JSON file that describes our smart contract. This JSON file is output by the Solidity compiler. By reading this specification, a library like Ethers knows how to represent our smart contract in JavaScript. The ABI contains an array of functions. Each has a name, a type (eg. constructor), and a list of inputs and outputs.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&#34;_format&#34;</span><span class="p">:</span> <span class="s2">&#34;hh-sol-artifact-1&#34;</span><span class="p">,</span>
  <span class="nt">&#34;contractName&#34;</span><span class="p">:</span> <span class="s2">&#34;Calend3&#34;</span><span class="p">,</span>
  <span class="nt">&#34;sourceName&#34;</span><span class="p">:</span> <span class="s2">&#34;contracts/Calend3.sol&#34;</span><span class="p">,</span>
  <span class="nt">&#34;abi&#34;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&#34;inputs&#34;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="nt">&#34;stateMutability&#34;</span><span class="p">:</span> <span class="s2">&#34;nonpayable&#34;</span><span class="p">,</span>
      <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;constructor&#34;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&#34;inputs&#34;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nt">&#34;internalType&#34;</span><span class="p">:</span> <span class="s2">&#34;string&#34;</span><span class="p">,</span>
          <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;title&#34;</span><span class="p">,</span>
          <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;string&#34;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="nt">&#34;internalType&#34;</span><span class="p">:</span> <span class="s2">&#34;uint256&#34;</span><span class="p">,</span>
          <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;startTime&#34;</span><span class="p">,</span>
          <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;uint256&#34;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="nt">&#34;internalType&#34;</span><span class="p">:</span> <span class="s2">&#34;uint256&#34;</span><span class="p">,</span>
          <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;endTime&#34;</span><span class="p">,</span>
          <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;uint256&#34;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;createAppointment&#34;</span><span class="p">,</span>
      <span class="nt">&#34;outputs&#34;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="nt">&#34;stateMutability&#34;</span><span class="p">:</span> <span class="s2">&#34;payable&#34;</span><span class="p">,</span>
      <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;function&#34;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&#34;inputs&#34;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;getAppointments&#34;</span><span class="p">,</span>
      <span class="nt">&#34;outputs&#34;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nt">&#34;components&#34;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="nt">&#34;internalType&#34;</span><span class="p">:</span> <span class="s2">&#34;string&#34;</span><span class="p">,</span>
              <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;title&#34;</span><span class="p">,</span>
              <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;string&#34;</span>
            <span class="p">},</span>
            <span class="p">{</span>
              <span class="nt">&#34;internalType&#34;</span><span class="p">:</span> <span class="s2">&#34;address&#34;</span><span class="p">,</span>
              <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;attendee&#34;</span><span class="p">,</span>
              <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;address&#34;</span>
            <span class="p">},</span>
            <span class="p">{</span>
              <span class="nt">&#34;internalType&#34;</span><span class="p">:</span> <span class="s2">&#34;uint256&#34;</span><span class="p">,</span>
              <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;startTime&#34;</span><span class="p">,</span>
              <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;uint256&#34;</span>
            <span class="p">},</span>
            <span class="p">{</span>
              <span class="nt">&#34;internalType&#34;</span><span class="p">:</span> <span class="s2">&#34;uint256&#34;</span><span class="p">,</span>
              <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;endTime&#34;</span><span class="p">,</span>
              <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;uint256&#34;</span>
            <span class="p">},</span>
            <span class="p">{</span>
              <span class="nt">&#34;internalType&#34;</span><span class="p">:</span> <span class="s2">&#34;uint256&#34;</span><span class="p">,</span>
              <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;amountPaid&#34;</span><span class="p">,</span>
              <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;uint256&#34;</span>
            <span class="p">}</span>
          <span class="p">],</span>
          <span class="nt">&#34;internalType&#34;</span><span class="p">:</span> <span class="s2">&#34;struct Calend3.Appointment[]&#34;</span><span class="p">,</span>
          <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
          <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;tuple[]&#34;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="nt">&#34;stateMutability&#34;</span><span class="p">:</span> <span class="s2">&#34;view&#34;</span><span class="p">,</span>
      <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;function&#34;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&#34;inputs&#34;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;getRate&#34;</span><span class="p">,</span>
      <span class="nt">&#34;outputs&#34;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nt">&#34;internalType&#34;</span><span class="p">:</span> <span class="s2">&#34;uint256&#34;</span><span class="p">,</span>
          <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
          <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;uint256&#34;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="nt">&#34;stateMutability&#34;</span><span class="p">:</span> <span class="s2">&#34;view&#34;</span><span class="p">,</span>
      <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;function&#34;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&#34;inputs&#34;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;owner&#34;</span><span class="p">,</span>
      <span class="nt">&#34;outputs&#34;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nt">&#34;internalType&#34;</span><span class="p">:</span> <span class="s2">&#34;address payable&#34;</span><span class="p">,</span>
          <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
          <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;address&#34;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="nt">&#34;stateMutability&#34;</span><span class="p">:</span> <span class="s2">&#34;view&#34;</span><span class="p">,</span>
      <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;function&#34;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&#34;inputs&#34;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nt">&#34;internalType&#34;</span><span class="p">:</span> <span class="s2">&#34;uint256&#34;</span><span class="p">,</span>
          <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;_rate&#34;</span><span class="p">,</span>
          <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;uint256&#34;</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;setRate&#34;</span><span class="p">,</span>
      <span class="nt">&#34;outputs&#34;</span><span class="p">:</span> <span class="p">[],</span>
      <span class="nt">&#34;stateMutability&#34;</span><span class="p">:</span> <span class="s2">&#34;nonpayable&#34;</span><span class="p">,</span>
      <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;function&#34;</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">&#34;bytecode&#34;</span><span class="p">:</span> <span class="s2">&#34;0x608060405234801561001057600080fd5b5033600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550610e6e806100616000396000f3fe60806040526004361061004a5760003560e01c806334fcf4&#34;</span><span class="p">,</span>
  <span class="nt">&#34;deployedBytecode&#34;</span><span class="p">:</span> <span class="s2">&#34;0x60806040526004361061004a5760003560e01c806334fcf4371461004f57806359c35bdf14610078578063679aefce146100945780638da5cb5b146100bf57806396b80d08146100ea575b600080fd5b&#34;</span><span class="p">,</span>
  <span class="nt">&#34;linkReferences&#34;</span><span class="p">:</span> <span class="p">{},</span>
  <span class="nt">&#34;deployedLinkReferences&#34;</span><span class="p">:</span> <span class="p">{}</span>
<span class="p">}</span>
</code></pre></div><h1 id="using-ethersjs">Using Ethers.js</h1>
<p>To get started with <strong>ethers.js</strong>, let&rsquo;s first make our <strong>ABI file</strong> accessible to our frontend. To do this, we&rsquo;ll update our <strong>deploy.js</strong> script so that it copies the generated ABI file to our <strong>frontend directory</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">Contract</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="s2">&#34;Calend3&#34;</span><span class="p">);</span>
  <span class="kr">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">Contract</span><span class="p">.</span><span class="nx">deploy</span><span class="p">();</span>

  <span class="kr">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;Calend3 deployed to:&#34;</span><span class="p">,</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>

  <span class="nx">saveFrontendFiles</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">saveFrontendFiles</span><span class="p">()</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;fs&#34;</span><span class="p">);</span>

  <span class="kr">const</span> <span class="nx">abiDir</span> <span class="o">=</span> <span class="nx">__dirname</span> <span class="o">+</span> <span class="s2">&#34;/../frontend/src/abis&#34;</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fs</span><span class="p">.</span><span class="nx">existsSync</span><span class="p">(</span><span class="nx">abiDir</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">fs</span><span class="p">.</span><span class="nx">mkdirSync</span><span class="p">(</span><span class="nx">abiDir</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kr">const</span> <span class="nx">artifact</span> <span class="o">=</span> <span class="nx">artifacts</span><span class="p">.</span><span class="nx">readArtifactSync</span><span class="p">(</span><span class="s2">&#34;Calend3&#34;</span><span class="p">);</span>

  <span class="nx">fs</span><span class="p">.</span><span class="nx">writeFileSync</span><span class="p">(</span>
    <span class="nx">abiDir</span> <span class="o">+</span> <span class="s2">&#34;/Calend3.json&#34;</span><span class="p">,</span>
    <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">artifact</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
  <span class="p">);</span>
<span class="p">}</span>
</code></pre></div><p>This script reads the Calend3.json in the artifacts directory and copies it to a directory where our webapp can access them. Notice how it creates a new directory in frontend/src named <strong>abis</strong>.</p>
<p>Let&rsquo;s redeploy our smart contract now and verify that this file is copied. Also, take note of the contract address because we will need it in a moment.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">npx hardhat run scripts/deploy.js --network goerli
Calend3 deployed to: 0x71E713E992a0183767df0aF2C58C5b224e8d7Ac3
</code></pre></div><h2 id="creating-an-etherjs-contract-object">Creating an ether.js Contract object</h2>
<p>Now that our ABI is in place, let&rsquo;s create an ethers.js Contract object to use it. First, we must <strong>import the ABI file in components/Calendar.js</strong>. We&rsquo;ll also import <strong>ethers</strong> and the <strong>useState</strong> and <strong>useEffect</strong> hooks.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="kr">import</span> <span class="p">{</span> <span class="nx">useState</span><span class="p">,</span> <span class="nx">useEffect</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">ethers</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;ethers&#34;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">abi</span> <span class="nx">from</span> <span class="s2">&#34;../abis/Calend3.json&#34;</span><span class="p">;</span>
</code></pre></div><p>Now we will create an instance of the ethers.Contract object. With this contract object, we will be able to call our smart contract functions the same way we call a JavaScript function.</p>
<p>The contract object requires a contract address, a web3 provider, and a contract ABI. The contract address was given to us when we deployed our contract to the Goerli testnet. The ethers web3 provider accepts the window.ethereum object injected by Metamask.</p>
<p>Add the following code below the import statements in components/Calendar.js:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">contractAddress</span> <span class="o">=</span> <span class="s2">&#34;0xYOURCONTRACTADDRESS&#34;</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">contractABI</span> <span class="o">=</span> <span class="nx">abi</span><span class="p">.</span><span class="nx">abi</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">provider</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">providers</span><span class="p">.</span><span class="nx">Web3Provider</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">ethereum</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">Contract</span><span class="p">(</span><span class="nx">contractAddress</span><span class="p">,</span> <span class="nx">contractABI</span><span class="p">,</span> <span class="nx">provider</span><span class="p">.</span><span class="nx">getSigner</span><span class="p">());</span>  
</code></pre></div><p>Now that we have everything configured, we are ready to call our functions using the <strong>contract</strong> object.</p>
<h1 id="admin-user-and-setting-a-rate">Admin User and Setting a Rate</h1>
<p>The first thing we will do is set a minutely rate for the appointments. We could set this when we deploy our smart contract, but in this case we want to give the admin a slider where they can adjust the rate from the web.</p>
<h2 id="admin-ui-state-variables">Admin UI State Variables</h2>
<p>We will need to keep track of a few state variables. We&rsquo;ll use hooks to update the state of these variables when the admin interacts with the app.</p>
<h3 id="isadmin-and-setisadmin">isAdmin and setIsAdmin()</h3>
<p>First, we will show an &ldquo;Admin&rdquo; button if the connected user owns the smart contract. Let&rsquo;s create a variable called <strong>isAdmin</strong> to store whether or not the user is an admin. When the app loads, we will compare the contract owner&rsquo;s address to the connected wallet&rsquo;s address. If they are the same, we will use <strong>setIsAdmin()</strong> to set <strong>isAdmin</strong> to <em><strong>true</strong></em>. We will also allow the user show and hide the admin panel, so we&rsquo;ll create another state variable called <strong>showAdmin</strong> for this purpose.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="p">[</span><span class="nx">isAdmin</span><span class="p">,</span> <span class="nx">setIsAdmin</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="kr">const</span> <span class="p">[</span><span class="nx">showAdmin</span><span class="p">,</span> <span class="nx">setShowAdmin</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
</code></pre></div><p>The third thing we&rsquo;ll need to track is the current minutely rate. When the page first loads, no rate is set. We must check the current rate by calling our smart contract. Once we know the rate, we will use setRate to update the state of our UI. We will also call setRate each time the admin moves the slider and saves a new rate.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="p">[</span><span class="nx">rate</span><span class="p">,</span> <span class="nx">setRate</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
</code></pre></div><p>Define all of your state variables at the top of the Calendar component like so:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx">  <span class="kr">const</span> <span class="nx">Calendar</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="c1">// admin rate setting functionality
</span><span class="c1"></span>    <span class="kr">const</span> <span class="p">[</span><span class="nx">showAdmin</span><span class="p">,</span> <span class="nx">setShowAdmin</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
    <span class="kr">const</span> <span class="p">[</span><span class="nx">isAdmin</span><span class="p">,</span> <span class="nx">setIsAdmin</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
    <span class="kr">const</span> <span class="p">[</span><span class="nx">rate</span><span class="p">,</span> <span class="nx">setRate</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>

    <span class="kr">const</span> <span class="nx">getData</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="c1">// get contract owner and set admin if connected account is owner
</span><span class="c1"></span>      <span class="kr">const</span> <span class="nx">owner</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">owner</span><span class="p">();</span>
      <span class="nx">setIsAdmin</span><span class="p">(</span><span class="nx">owner</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span> <span class="o">===</span> <span class="nx">account</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">());</span>

      <span class="kr">const</span> <span class="nx">rate</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getRate</span><span class="p">();</span>
      <span class="nx">setRate</span><span class="p">(</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">formatEther</span><span class="p">(</span><span class="nx">rate</span><span class="p">.</span><span class="nx">toString</span><span class="p">()));</span>
    <span class="p">}</span> 
  <span class="p">}</span>
</code></pre></div><h2 id="making-mistakes-and-fixing-them">Making Mistakes and Fixing Them</h2>
<p>When we reload the page, we notice that the JavaScript developer console shows an error. I unintentionally ran into a few errors when writing this tutorial. Rather than edit them out, I like to leave these in sometimes so that we can practice fixing some issues. The first error is:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">Uncaught <span class="o">(</span>in promise<span class="o">)</span> TypeError: contract.owner is not a <span class="k">function</span>
</code></pre></div><p>This occured because we did not make the owner <strong>public</strong> in our smart contract. Since we need to access the owner of the contract from the web, we need to make the owner variable in Calend3.sol public:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-solidity" data-lang="solidity"><span class="kt">address</span> <span class="k">payable</span> <span class="k">public</span> <span class="n">owner</span><span class="p">;</span>
</code></pre></div><p>Now that this has been updated, we need to redeploy the contract. Since we have updated our deploy.js to automatically copy the latest ABI file, we don&rsquo;t need to copy it manually after our change. We do, however, need to update the contract address in Calendar.js redeploying it will change the address.</p>
<p>When we refresh the app, we see yet another error:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">Uncaught <span class="o">(</span>in promise<span class="o">)</span> TypeError: Cannot <span class="nb">read</span> properties of undefined <span class="o">(</span>reading <span class="s1">&#39;toUpperCase&#39;</span><span class="o">)</span>
</code></pre></div><p>This occurs because the <strong>account</strong> variable that we defined in App.js is not available in <strong>Calendar.js</strong>. It needs to get there somehow. In App.js we will pass the connected account to the Calendar component as a <strong>prop</strong>. In App.js, find the line where we place the Calendar component and pass in an account prop:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="p">{</span><span class="nx">account</span> <span class="o">&amp;&amp;</span> <span class="p">&lt;</span><span class="nt">Calendar</span> <span class="na">account</span><span class="o">=</span><span class="p">{</span><span class="nx">account</span><span class="p">}</span> <span class="p">/&gt;}</span>
</code></pre></div><p>Then we can receive any <strong>props</strong> passed into the Calendar component by adding <strong>props</strong> as a parameter in <strong>Calendar.js</strong>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">Calendar</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</code></pre></div><p>Once the props are available, we can access account with props.account:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">setIsAdmin</span><span class="p">(</span><span class="nx">owner</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span> <span class="o">===</span> <span class="nx">props</span><span class="p">.</span><span class="nx">account</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">());</span>
</code></pre></div><p>At this point, we have <strong>read data from the blockchain</strong> and set state variables for <strong>rate</strong> and <strong>isAdmin</strong>. We will now use these variables to add a rate slider.</p>
<h2 id="admin-ui-slider-component">Admin UI Slider Component</h2>
<p>Now that we have our state variables and hooks in place, let&rsquo;s add the slider component to our app. We&rsquo;ll use the Material UI Slider component, which is <a href="https://mui.com/components/slider/">documented here</a>. We&rsquo;ll define our own component called Admin that contains the slider. We&rsquo;ll show and hide the Admin component depending on whether the user is an admin or not.</p>
<p>First, let&rsquo;s import a few Material UI components that we will be using:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Box</span><span class="p">,</span> <span class="nx">Button</span><span class="p">,</span> <span class="nx">Slider</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@material-ui/core&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">SettingsSuggestIcon</span> <span class="nx">from</span> <span class="s1">&#39;@mui/icons-material/SettingsSuggest&#39;</span><span class="p">;</span>
</code></pre></div><p>If you get an error about @material-ui/core, you can install it with npm in your frontend/ directory:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="nx">npm</span> <span class="nx">install</span> <span class="err">@</span><span class="nx">material</span><span class="o">-</span><span class="nx">ui</span><span class="o">/</span><span class="nx">core</span>
</code></pre></div><p>Now let&rsquo;s create the Admin component and use Box, Button and Slider within it. We&rsquo;ll also define two functions called saveRate() and handleSliderChange(). The first function handleSliderChange() handles updating the rate variable when the slider moves. The second functino saveRate() calls the smart contract setRate() function and saves the value to the blockchain.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="kr">const</span> <span class="nx">handleSliderChange</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">newValue</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">setRate</span><span class="p">(</span><span class="nx">newValue</span><span class="p">);</span>
<span class="p">};</span>

<span class="kr">const</span> <span class="nx">saveRate</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">tx</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">setRate</span><span class="p">(</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="nx">rate</span><span class="p">.</span><span class="nx">toString</span><span class="p">()));</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="nx">Admin</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">Box</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">Set</span> <span class="nx">Your</span> <span class="nx">Minutely</span> <span class="nx">Rate</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">Slider</span> <span class="na">defaultValue</span><span class="o">=</span><span class="p">{</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">rate</span><span class="p">)}</span> 
                <span class="na">step</span><span class="o">=</span><span class="p">{</span><span class="mf">0.001</span><span class="p">}</span> 
                <span class="na">min</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> 
                <span class="na">max</span><span class="o">=</span><span class="p">{</span><span class="mf">.1</span><span class="p">}</span> 
                <span class="na">valueLabelDisplay</span><span class="o">=</span><span class="s">&#34;auto&#34;</span>
                <span class="na">onChangeCommitted</span><span class="o">=</span><span class="p">{</span><span class="nx">handleSliderChange</span><span class="p">}</span> <span class="p">/&gt;</span>
            <span class="p">&lt;</span><span class="nt">br</span> <span class="p">/&gt;&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
            <span class="p">&lt;</span><span class="nt">Button</span> <span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">saveRate</span><span class="p">}</span> <span class="na">variant</span><span class="o">=</span><span class="s">&#34;contained&#34;</span><span class="p">&gt;</span><span class="nx">save</span> <span class="nx">configuration</span><span class="p">&lt;/</span><span class="nt">Button</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">Box</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">}</span>
</code></pre></div><p>Next we will add some logic to our JSX to display the Admin component above the calendar:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="k">return</span> <span class="p">(&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">{</span><span class="nx">isAdmin</span> <span class="o">&amp;&amp;</span> <span class="p">&lt;</span><span class="nt">Button</span> <span class="na">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="p">=&gt;</span> <span class="nx">setShowAdmin</span><span class="p">(</span><span class="o">!</span><span class="nx">showAdmin</span><span class="p">)}</span> <span class="na">variant</span><span class="o">=</span><span class="s">&#34;contained&#34;</span> <span class="na">startIcon</span><span class="o">=</span><span class="p">{&lt;</span><span class="nt">SettingsSuggestIcon</span> <span class="p">/&gt;}&gt;</span>
        <span class="nx">Admin</span>
    <span class="p">&lt;/</span><span class="nt">Button</span><span class="p">&gt;}</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">{</span><span class="nx">showAdmin</span> <span class="o">&amp;&amp;</span> <span class="p">&lt;</span><span class="nt">Admin</span> <span class="p">/&gt;}</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;calendar&#34;</span><span class="p">&gt;</span>
</code></pre></div><p>Once this is done, you should be able to see the admin section when the owner of the contract is connected to the Calendar dapp. If a different wallet is connected, the admin section should not appear.</p>
<h3 id="additional-styling">Additional Styling</h3>
<p>To make the slider more user-friendly, we can customize it and add some &ldquo;marks&rdquo; on the slider. Also, this is a good point to add any styles to make the app your own. Give it a unique look and feel.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">marks</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="nx">value</span><span class="o">:</span> <span class="mf">0.00</span><span class="p">,</span>
    <span class="nx">label</span><span class="o">:</span> <span class="s1">&#39;Free&#39;</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="nx">value</span><span class="o">:</span> <span class="mf">0.02</span><span class="p">,</span>
    <span class="nx">label</span><span class="o">:</span> <span class="s1">&#39;0.02 ETH/min&#39;</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="nx">value</span><span class="o">:</span> <span class="mf">0.04</span><span class="p">,</span>
    <span class="nx">label</span><span class="o">:</span> <span class="s1">&#39;0.04 ETH/min&#39;</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="p">{</span>
      <span class="nx">value</span><span class="o">:</span> <span class="mf">0.06</span><span class="p">,</span>
      <span class="nx">label</span><span class="o">:</span> <span class="s1">&#39;0.06 ETH/min&#39;</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="p">{</span>
      <span class="nx">value</span><span class="o">:</span> <span class="mf">0.08</span><span class="p">,</span>
      <span class="nx">label</span><span class="o">:</span> <span class="s1">&#39;0.08 ETH/min&#39;</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="nx">value</span><span class="o">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="nx">label</span><span class="o">:</span> <span class="s1">&#39;Expensive&#39;</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">];</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="p">&lt;</span><span class="nt">Slider</span> <span class="na">defaultValue</span><span class="o">=</span><span class="p">{</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">rate</span><span class="p">)}</span> 
    <span class="na">step</span><span class="o">=</span><span class="p">{</span><span class="mf">0.001</span><span class="p">}</span> 
    <span class="na">min</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> 
    <span class="na">max</span><span class="o">=</span><span class="p">{</span><span class="mf">.1</span><span class="p">}</span> 
    <span class="na">valueLabelDisplay</span><span class="o">=</span><span class="s">&#34;auto&#34;</span>
    <span class="na">marks</span><span class="o">=</span><span class="p">{</span><span class="nx">marks</span><span class="p">}</span>
    <span class="na">onChangeCommitted</span><span class="o">=</span><span class="p">{</span><span class="nx">handleSliderChange</span><span class="p">}</span> <span class="p">/&gt;</span>
</code></pre></div><h1 id="fetching-appointments">Fetching Appointments</h1>
<p>To fetch appointments, we just need to call <strong>getAppointments()</strong> on our smart contract. We&rsquo;ll need to transform our data slightly to match the format expected the React Scheduler component. Let&rsquo;s add a call to <strong>contract.getAppointments()</strong> in the <strong>getData()</strong> function that runs on load.</p>
<p>First, define a state variable to hold the appointments. Initially, the appointments array will be empty, so we initialize it using <strong>useState([])</strong>. Once we fetch the appointments from the smart contract, we will call <strong>setAppointments()</strong> to update the state of appointments.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="c1">// appointment setting and storage
</span><span class="c1"></span><span class="kr">const</span> <span class="p">[</span><span class="nx">appointments</span><span class="p">,</span> <span class="nx">setAppointments</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">([]);</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="kr">const</span> <span class="nx">Calendar</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="c1">// admin rate setting functionality
</span><span class="c1"></span>    <span class="kr">const</span> <span class="p">[</span><span class="nx">showAdmin</span><span class="p">,</span> <span class="nx">setShowAdmin</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
    <span class="kr">const</span> <span class="p">[</span><span class="nx">isAdmin</span><span class="p">,</span> <span class="nx">setIsAdmin</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
    <span class="kr">const</span> <span class="p">[</span><span class="nx">rate</span><span class="p">,</span> <span class="nx">setRate</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
    <span class="kr">const</span> <span class="p">[</span><span class="nx">appointments</span><span class="p">,</span> <span class="nx">setAppointments</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">([]);</span>

    <span class="kr">const</span> <span class="nx">getData</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="c1">// get contract owner and set admin if connected account is owner
</span><span class="c1"></span>        <span class="kr">const</span> <span class="nx">owner</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">owner</span><span class="p">();</span>
        <span class="nx">setIsAdmin</span><span class="p">(</span><span class="nx">owner</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span> <span class="o">===</span> <span class="nx">props</span><span class="p">.</span><span class="nx">account</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">());</span>

        <span class="kr">const</span> <span class="nx">rate</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getRate</span><span class="p">();</span>
        <span class="nx">setRate</span><span class="p">(</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">formatEther</span><span class="p">(</span><span class="nx">rate</span><span class="p">.</span><span class="nx">toString</span><span class="p">()));</span>

        <span class="kr">const</span> <span class="nx">appointmentData</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getAppointments</span><span class="p">();</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;got appointments&#39;</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">appointmentData</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">useEffect</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">getData</span><span class="p">();</span>
    <span class="p">},</span> <span class="p">[]);</span>
</code></pre></div><p>If all went according to plan, you should see &lsquo;got appointments&rsquo; in your web browser&rsquo;s JavaScript console.</p>
<h2 id="transforming-appointment-data">Transforming Appointment Data</h2>
<p>Note how the mock data we used has a slightly different format than the data returned by our smart contract.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">schedulerData</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span> <span class="nx">startDate</span><span class="o">:</span> <span class="s1">&#39;2022-02-24T09:45&#39;</span><span class="p">,</span> <span class="nx">endDate</span><span class="o">:</span> <span class="s1">&#39;2022-02-24T11:00&#39;</span><span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Dogecoin Integration&#39;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nx">startDate</span><span class="o">:</span> <span class="s1">&#39;2022-02-25T12:00&#39;</span><span class="p">,</span> <span class="nx">endDate</span><span class="o">:</span> <span class="s1">&#39;2022-02-25T13:30&#39;</span><span class="p">,</span> <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;A Podcast Appearance&#39;</span> <span class="p">},</span>
  <span class="p">];</span>
</code></pre></div><p>The React scheduler requires the data to be in the above format. To handle this, we will write a small function called transformAppointmentData() to transform the data before feeding it into the Scheduler component.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">transformAppointmentData</span> <span class="o">=</span> <span class="p">(</span><span class="nx">appointmentData</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="nx">appointmentData</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">appointment</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="nx">data</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
        <span class="nx">title</span><span class="o">:</span> <span class="nx">appointment</span><span class="p">.</span><span class="nx">title</span><span class="p">,</span>
        <span class="nx">startDate</span><span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">appointment</span><span class="p">.</span><span class="nx">startTime</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">),</span>
        <span class="nx">endDate</span><span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">appointment</span><span class="p">.</span><span class="nx">endTime</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">),</span>
      <span class="p">});</span>
    <span class="p">});</span>

    <span class="nx">setAppointments</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><p>Then we simply call transformAppointmentData from getData():</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">appointmentData</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getAppointments</span><span class="p">();</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;got appointments&#39;</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">appointmentData</span><span class="p">);</span>
<span class="nx">transformAppointmentData</span><span class="p">(</span><span class="nx">appointmentData</span><span class="p">);</span>
</code></pre></div><p>Now instead of using the mock schedulerData we hardcoded in previously, we can pass the real data in to the Scheduler component:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="p">&lt;</span><span class="nt">Scheduler</span> <span class="na">data</span><span class="o">=</span><span class="p">{</span><span class="nx">appointments</span><span class="p">}&gt;</span>
</code></pre></div><p>At this point, we have all the necessary code to render appointments on the calendar. But we haven&rsquo;t created any appointments yet! Let&rsquo;s change that.</p>
<h2 id="creating-an-appointment">Creating an Appointment</h2>
<p>So far the appointments array is empty. This is because we haven&rsquo;t created an appointment yet. We will use the same technique to call createAppointment() when the appointment form is saved. If you recall, the React Scheduler component submits data that has the following structure:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="p">{</span>
    <span class="s2">&#34;added&#34;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&#34;title&#34;</span><span class="o">:</span> <span class="s2">&#34;test appointment&#34;</span><span class="p">,</span>
        <span class="s2">&#34;startDate&#34;</span><span class="o">:</span> <span class="s2">&#34;2022-02-08T18:00:00.000Z&#34;</span><span class="p">,</span>
        <span class="s2">&#34;endDate&#34;</span><span class="o">:</span> <span class="s2">&#34;2022-02-08T18:30:00.000Z&#34;</span><span class="p">,</span>
        <span class="s2">&#34;allDay&#34;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="s2">&#34;notes&#34;</span><span class="o">:</span> <span class="s2">&#34;some notes&#34;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>So all we need to do is feed this data to contract.createAppointment(). We will also calculate the cost of the meeting on the frontend and pass it in an input named <strong>msg</strong>. This will result in the user sending ether on appointment creation. This value is validated on the backend by our smart contract, so if the user attempts to send less ether than required, the transaction will fail.</p>
<h2 id="create-appointment">Create Appointment</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="kr">const</span> <span class="nx">saveAppointment</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">appointment</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">added</span><span class="p">;</span>
  <span class="kr">const</span> <span class="nx">title</span> <span class="o">=</span> <span class="nx">appointment</span><span class="p">.</span><span class="nx">title</span><span class="p">;</span>
  <span class="kr">const</span> <span class="nx">startTime</span> <span class="o">=</span> <span class="nx">appointment</span><span class="p">.</span><span class="nx">startDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">;</span>
  <span class="kr">const</span> <span class="nx">endTime</span> <span class="o">=</span> <span class="nx">appointment</span><span class="p">.</span><span class="nx">endDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">;</span>

  <span class="k">try</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">cost</span> <span class="o">=</span> <span class="p">((</span><span class="nx">endTime</span> <span class="o">-</span> <span class="nx">startTime</span><span class="p">)</span> <span class="o">/</span> <span class="mi">60</span><span class="p">)</span> <span class="o">*</span> <span class="nx">rate</span><span class="p">;</span>
      <span class="kr">const</span> <span class="nx">msg</span> <span class="o">=</span> <span class="p">{</span><span class="nx">value</span><span class="o">:</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="nx">cost</span><span class="p">.</span><span class="nx">toString</span><span class="p">())};</span>
      <span class="kd">let</span> <span class="nx">transaction</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">createAppointment</span><span class="p">(</span><span class="nx">title</span><span class="p">,</span> <span class="nx">startTime</span><span class="p">,</span> <span class="nx">endTime</span><span class="p">,</span> <span class="nx">msg</span><span class="p">);</span>
      
      <span class="kr">await</span> <span class="nx">transaction</span><span class="p">.</span><span class="nx">wait</span><span class="p">();</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>At this point, our appointment creation function works, but it isn&rsquo;t very user-friendly. There are a few problems:</p>
<ol>
<li>We have to refresh the page to see the appointment appear on the calendar.</li>
<li>We don&rsquo;t have any indication of when the transaction has been completed</li>
<li>The user has no way to verify the transaction.</li>
</ol>
<h1 id="dialogs-and-progress-indicators">Dialogs and Progress Indicators</h1>
<p>To improve the user experience, let&rsquo;s add a Dialog that shows the status of the transaction. Once the transaction is complete, we will display an Etherscan link with the transaction hash so that the user can verify it on the blockchain. First, we&rsquo;ll create a few state variables to store the status of the UI. We&rsquo;ll need to track:</p>
<ol>
<li>Whether the Dialog should be shown or not</li>
<li>Whether the user is on the sign transaction step</li>
<li>Whether the transaction has completed mining</li>
<li>The transaction hash</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="kr">const</span> <span class="p">[</span><span class="nx">showDialog</span><span class="p">,</span> <span class="nx">setShowDialog</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="kr">const</span> <span class="p">[</span><span class="nx">showSign</span><span class="p">,</span> <span class="nx">setShowSign</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="kr">const</span> <span class="p">[</span><span class="nx">mined</span><span class="p">,</span> <span class="nx">setMined</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="kr">const</span> <span class="p">[</span><span class="nx">transactionHash</span><span class="p">,</span> <span class="nx">setTransactionHash</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">);</span>
</code></pre></div><p>Now let&rsquo;s import the Material UI components that we will be using: Dialog and CircularProgress:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="kr">import</span> <span class="nx">Dialog</span> <span class="nx">from</span> <span class="s1">&#39;@mui/material/Dialog&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">CircularProgress</span> <span class="nx">from</span> <span class="s1">&#39;@mui/material/CircularProgress&#39;</span><span class="p">;</span>
</code></pre></div><p>Then, we update the state appropriately during each stage of the saveAppointment process:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="kr">const</span> <span class="nx">saveAppointment</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">appointment</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">added</span><span class="p">;</span>
  <span class="kr">const</span> <span class="nx">title</span> <span class="o">=</span> <span class="nx">appointment</span><span class="p">.</span><span class="nx">title</span><span class="p">;</span>
  <span class="kr">const</span> <span class="nx">startTime</span> <span class="o">=</span> <span class="nx">appointment</span><span class="p">.</span><span class="nx">startDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">;</span>
  <span class="kr">const</span> <span class="nx">endTime</span> <span class="o">=</span> <span class="nx">appointment</span><span class="p">.</span><span class="nx">endDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">;</span>

  <span class="nx">setShowSign</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
  <span class="nx">setShowDialog</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
  <span class="nx">setMined</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>

  <span class="k">try</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">cost</span> <span class="o">=</span> <span class="p">((</span><span class="nx">endTime</span> <span class="o">-</span> <span class="nx">startTime</span><span class="p">)</span> <span class="o">/</span> <span class="mi">60</span><span class="p">)</span> <span class="o">*</span> <span class="nx">rate</span><span class="p">;</span>
      <span class="kr">const</span> <span class="nx">msg</span> <span class="o">=</span> <span class="p">{</span><span class="nx">value</span><span class="o">:</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="nx">cost</span><span class="p">.</span><span class="nx">toString</span><span class="p">())};</span>
      <span class="kd">let</span> <span class="nx">transaction</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">createAppointment</span><span class="p">(</span><span class="nx">title</span><span class="p">,</span> <span class="nx">startTime</span><span class="p">,</span> <span class="nx">endTime</span><span class="p">,</span> <span class="nx">msg</span><span class="p">);</span>
      
      <span class="nx">setShowSign</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>

      <span class="kr">await</span> <span class="nx">transaction</span><span class="p">.</span><span class="nx">wait</span><span class="p">();</span>

      <span class="nx">setMined</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
      <span class="nx">setTransactionHash</span><span class="p">(</span><span class="nx">transaction</span><span class="p">.</span><span class="nx">hash</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>We&rsquo;ll create our own ConfirmDialog component and show different messages to the user depending on the status of the transaction.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="kr">const</span> <span class="nx">ConfirmDialog</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">&lt;</span><span class="nt">Dialog</span> <span class="na">open</span><span class="o">=</span><span class="p">{</span><span class="kc">true</span><span class="p">}&gt;</span>
      <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>
        <span class="p">{</span><span class="nx">mined</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;Appointment Confirmed&#39;</span><span class="p">}</span>
        <span class="p">{</span><span class="o">!</span><span class="nx">mined</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">showSign</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;Confirming Your Appointment...&#39;</span><span class="p">}</span>
        <span class="p">{</span><span class="o">!</span><span class="nx">mined</span> <span class="o">&amp;&amp;</span> <span class="nx">showSign</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;Please Sign to Confirm&#39;</span><span class="p">}</span>
      <span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="p">{{</span><span class="nx">textAlign</span><span class="o">:</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="nx">padding</span><span class="o">:</span> <span class="s1">&#39;0px 20px 20px 20px&#39;</span><span class="p">}}&gt;</span>
          <span class="p">{</span><span class="nx">mined</span> <span class="o">&amp;&amp;</span> <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="nx">Your</span> <span class="nx">appointment</span> <span class="nx">has</span> <span class="nx">been</span> <span class="nx">confirmed</span> <span class="nx">and</span> <span class="nx">is</span> <span class="nx">on</span> <span class="nx">the</span> <span class="nx">blockchain</span><span class="p">.&lt;</span><span class="nt">br</span> <span class="p">/&gt;&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
            <span class="p">&lt;</span><span class="nt">a</span> <span class="na">target</span><span class="o">=</span><span class="s">&#34;_blank&#34;</span> <span class="na">href</span><span class="o">=</span><span class="p">{</span><span class="sb">`https://goerli.etherscan.io/tx/</span><span class="si">${</span><span class="nx">transactionHash</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;</span><span class="nx">View</span> <span class="nx">on</span> <span class="nx">Etherscan</span><span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;}</span>
        <span class="p">{</span><span class="o">!</span><span class="nx">mined</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">showSign</span> <span class="o">&amp;&amp;</span> <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Please</span> <span class="nx">wait</span> <span class="k">while</span> <span class="nx">we</span> <span class="nx">confirm</span> <span class="nx">your</span> <span class="nx">appoinment</span> <span class="nx">on</span> <span class="nx">the</span> <span class="nx">blockchain</span><span class="p">....&lt;/</span><span class="nt">p</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;}</span>
        <span class="p">{</span><span class="o">!</span><span class="nx">mined</span> <span class="o">&amp;&amp;</span> <span class="nx">showSign</span> <span class="o">&amp;&amp;</span> <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Please</span> <span class="nx">sign</span> <span class="nx">the</span> <span class="nx">transaction</span> <span class="nx">to</span> <span class="nx">confirm</span> <span class="nx">your</span> <span class="nx">appointment</span><span class="p">.&lt;/</span><span class="nt">p</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;}</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="p">{{</span><span class="nx">textAlign</span><span class="o">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="nx">paddingBottom</span><span class="o">:</span> <span class="s1">&#39;30px&#39;</span><span class="p">}}&gt;</span>
      <span class="p">{</span><span class="o">!</span><span class="nx">mined</span> <span class="o">&amp;&amp;</span> <span class="p">&lt;</span><span class="nt">CircularProgress</span> <span class="p">/&gt;}</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">{</span><span class="nx">mined</span> <span class="o">&amp;&amp;</span> 
      <span class="p">&lt;</span><span class="nt">Button</span> <span class="na">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="p">=&gt;</span> <span class="p">{</span>
          <span class="nx">setShowDialog</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
          <span class="nx">getData</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="p">}&gt;</span><span class="nx">Close</span><span class="p">&lt;/</span><span class="nt">Button</span><span class="p">&gt;}</span>
    <span class="p">&lt;/</span><span class="nt">Dialog</span><span class="p">&gt;</span>
  <span class="p">}</span>
</code></pre></div><p>Wow, that was a long section. We&rsquo;ll wrap this up in the next section by adding Notifications. Your final Calendar.js should look something like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-jsx" data-lang="jsx"><span class="kr">import</span> <span class="p">{</span> <span class="nx">useState</span><span class="p">,</span> <span class="nx">useEffect</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">ethers</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;ethers&#34;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">abi</span> <span class="nx">from</span> <span class="s2">&#34;../abis/Calend3.json&#34;</span><span class="p">;</span>

<span class="kr">import</span> <span class="p">{</span> <span class="nx">ViewState</span><span class="p">,</span> <span class="nx">EditingState</span><span class="p">,</span> <span class="nx">IntegratedEditing</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@devexpress/dx-react-scheduler&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">Scheduler</span><span class="p">,</span> <span class="nx">WeekView</span><span class="p">,</span> <span class="nx">Appointments</span><span class="p">,</span> <span class="nx">AppointmentForm</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@devexpress/dx-react-scheduler-material-ui&#39;</span><span class="p">;</span>

<span class="kr">import</span> <span class="p">{</span> <span class="nx">Box</span><span class="p">,</span> <span class="nx">Button</span><span class="p">,</span> <span class="nx">Slider</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@material-ui/core&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Dialog</span> <span class="nx">from</span> <span class="s1">&#39;@mui/material/Dialog&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">CircularProgress</span> <span class="nx">from</span> <span class="s1">&#39;@mui/material/CircularProgress&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">SettingsSuggestIcon</span> <span class="nx">from</span> <span class="s1">&#39;@mui/icons-material/SettingsSuggest&#39;</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">contractAddress</span> <span class="o">=</span> <span class="s2">&#34;0xYOURCONTRACTADDRESS&#34;</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">contractABI</span> <span class="o">=</span> <span class="nx">abi</span><span class="p">.</span><span class="nx">abi</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">provider</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">providers</span><span class="p">.</span><span class="nx">Web3Provider</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">ethereum</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">contract</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">Contract</span><span class="p">(</span><span class="nx">contractAddress</span><span class="p">,</span> <span class="nx">contractABI</span><span class="p">,</span> <span class="nx">provider</span><span class="p">.</span><span class="nx">getSigner</span><span class="p">());</span>

<span class="kr">const</span> <span class="nx">Calendar</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>

    <span class="c1">// state for admin and rate
</span><span class="c1"></span>    <span class="kr">const</span> <span class="p">[</span><span class="nx">isAdmin</span><span class="p">,</span> <span class="nx">setIsAdmin</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
    <span class="kr">const</span> <span class="p">[</span><span class="nx">showAdmin</span><span class="p">,</span> <span class="nx">setShowAdmin</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
    <span class="kr">const</span> <span class="p">[</span><span class="nx">rate</span><span class="p">,</span> <span class="nx">setRate</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
    <span class="kr">const</span> <span class="p">[</span><span class="nx">appointments</span><span class="p">,</span> <span class="nx">setAppointments</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">([]);</span>

    <span class="kr">const</span> <span class="p">[</span><span class="nx">showDialog</span><span class="p">,</span> <span class="nx">setShowDialog</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
    <span class="kr">const</span> <span class="p">[</span><span class="nx">showSign</span><span class="p">,</span> <span class="nx">setShowSign</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
    <span class="kr">const</span> <span class="p">[</span><span class="nx">mined</span><span class="p">,</span> <span class="nx">setMined</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
    <span class="kr">const</span> <span class="p">[</span><span class="nx">transactionHash</span><span class="p">,</span> <span class="nx">setTransactionHash</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">);</span>

    <span class="kr">const</span> <span class="nx">getData</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">owner</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">owner</span><span class="p">();</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">owner</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">());</span>

        <span class="nx">setIsAdmin</span><span class="p">(</span><span class="nx">owner</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span> <span class="o">===</span> <span class="nx">props</span><span class="p">.</span><span class="nx">account</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">());</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">account</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">());</span>

        <span class="kr">const</span> <span class="nx">rate</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getRate</span><span class="p">();</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">rate</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
        <span class="nx">setRate</span><span class="p">(</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">formatEther</span><span class="p">(</span><span class="nx">rate</span><span class="p">.</span><span class="nx">toString</span><span class="p">()));</span>

        <span class="kr">const</span> <span class="nx">appointmentData</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">getAppointments</span><span class="p">();</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;appointments&#39;</span><span class="p">,</span> <span class="nx">appointmentData</span><span class="p">);</span>

        <span class="nx">transformAppointmentData</span><span class="p">(</span><span class="nx">appointmentData</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kr">const</span> <span class="nx">transformAppointmentData</span> <span class="o">=</span> <span class="p">(</span><span class="nx">appointmentData</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="nx">appointmentData</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">appointment</span> <span class="p">=&gt;</span> <span class="p">{</span>
          <span class="nx">data</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="nx">appointment</span><span class="p">.</span><span class="nx">title</span><span class="p">,</span>
            <span class="nx">startDate</span><span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">appointment</span><span class="p">.</span><span class="nx">startTime</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">),</span>
            <span class="nx">endDate</span><span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">appointment</span><span class="p">.</span><span class="nx">endTime</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">),</span>
          <span class="p">});</span>
        <span class="p">});</span>
    
        <span class="nx">setAppointments</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">useEffect</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">getData</span><span class="p">();</span>
    <span class="p">},</span> <span class="p">[]);</span>

    <span class="kr">const</span> <span class="nx">saveAppointment</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;appointment saved&#39;</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>

        <span class="kr">const</span> <span class="nx">appointment</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">added</span><span class="p">;</span>
        <span class="kr">const</span> <span class="nx">title</span> <span class="o">=</span> <span class="nx">appointment</span><span class="p">.</span><span class="nx">title</span><span class="p">;</span>
        <span class="kr">const</span> <span class="nx">startTime</span> <span class="o">=</span> <span class="nx">appointment</span><span class="p">.</span><span class="nx">startDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">;</span>
        <span class="kr">const</span> <span class="nx">endTime</span> <span class="o">=</span> <span class="nx">appointment</span><span class="p">.</span><span class="nx">endDate</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">;</span>
      
        <span class="nx">setShowSign</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
        <span class="nx">setShowDialog</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
        <span class="nx">setMined</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>

        <span class="k">try</span> <span class="p">{</span>
            <span class="kr">const</span> <span class="nx">cost</span> <span class="o">=</span> <span class="p">((</span><span class="nx">endTime</span> <span class="o">-</span> <span class="nx">startTime</span><span class="p">)</span> <span class="o">/</span> <span class="mi">60</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nx">rate</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">;</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;cost: &#39;</span><span class="p">,</span> <span class="nx">cost</span><span class="p">);</span>

            <span class="kr">const</span> <span class="nx">msg</span> <span class="o">=</span> <span class="p">{</span><span class="nx">value</span><span class="o">:</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="nx">cost</span><span class="p">.</span><span class="nx">toString</span><span class="p">())};</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;message: &#39;</span><span class="p">,</span> <span class="nx">msg</span><span class="p">);</span>
            <span class="kd">let</span> <span class="nx">transaction</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">createAppointment</span><span class="p">(</span><span class="nx">title</span><span class="p">,</span> <span class="nx">startTime</span><span class="p">,</span> <span class="nx">endTime</span><span class="p">,</span> <span class="nx">msg</span><span class="p">);</span>
            
            <span class="nx">setShowSign</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
            
            <span class="kr">await</span> <span class="nx">transaction</span><span class="p">.</span><span class="nx">wait</span><span class="p">();</span>

            <span class="nx">setMined</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
            <span class="nx">setTransactionHash</span><span class="p">(</span><span class="nx">transaction</span><span class="p">.</span><span class="nx">hash</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kr">const</span> <span class="nx">saveRate</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;saving rate of &#39;</span><span class="p">,</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="nx">rate</span><span class="p">.</span><span class="nx">toString</span><span class="p">()));</span>
        
        <span class="kr">const</span> <span class="nx">tx</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">contract</span><span class="p">.</span><span class="nx">setRate</span><span class="p">(</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">parseEther</span><span class="p">(</span><span class="nx">rate</span><span class="p">.</span><span class="nx">toString</span><span class="p">()));</span>
    <span class="p">}</span>

    <span class="kr">const</span> <span class="nx">handleSliderChange</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">newValue</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;slider changed to&#39;</span><span class="p">,</span> <span class="nx">newValue</span><span class="p">);</span>
        <span class="nx">setRate</span><span class="p">(</span><span class="nx">newValue</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="kr">const</span> <span class="nx">marks</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="nx">value</span><span class="o">:</span> <span class="mf">0.00</span><span class="p">,</span>
        <span class="nx">label</span><span class="o">:</span> <span class="s1">&#39;Free&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="nx">value</span><span class="o">:</span> <span class="mf">0.02</span><span class="p">,</span>
        <span class="nx">label</span><span class="o">:</span> <span class="s1">&#39;0.02 ETH/min&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="nx">value</span><span class="o">:</span> <span class="mf">0.04</span><span class="p">,</span>
        <span class="nx">label</span><span class="o">:</span> <span class="s1">&#39;0.04 ETH/min&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="nx">value</span><span class="o">:</span> <span class="mf">0.06</span><span class="p">,</span>
        <span class="nx">label</span><span class="o">:</span> <span class="s1">&#39;0.06 ETH/min&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="nx">value</span><span class="o">:</span> <span class="mf">0.08</span><span class="p">,</span>
        <span class="nx">label</span><span class="o">:</span> <span class="s1">&#39;0.08 ETH/min&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="nx">value</span><span class="o">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="nx">label</span><span class="o">:</span> <span class="s1">&#39;Expensive&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">];</span>

    <span class="kr">const</span> <span class="nx">Admin</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;admin&#34;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">Box</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">Set</span> <span class="nx">Your</span> <span class="nx">Minutely</span> <span class="nx">Rate</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">Slider</span> <span class="na">defaultValue</span><span class="o">=</span><span class="p">{</span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">rate</span><span class="p">)}</span> 
                    <span class="na">step</span><span class="o">=</span><span class="p">{</span><span class="mf">0.001</span><span class="p">}</span> 
                    <span class="na">min</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> 
                    <span class="na">max</span><span class="o">=</span><span class="p">{</span><span class="mf">.1</span><span class="p">}</span>
                    <span class="na">marks</span><span class="o">=</span><span class="p">{</span><span class="nx">marks</span><span class="p">}</span>
                    <span class="na">valueLabelDisplay</span><span class="o">=</span><span class="s">&#34;auto&#34;</span>
                    <span class="na">onChangeCommitted</span><span class="o">=</span><span class="p">{</span><span class="nx">handleSliderChange</span><span class="p">}</span> <span class="p">/&gt;</span>
                <span class="p">&lt;</span><span class="nt">br</span> <span class="p">/&gt;&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
                <span class="p">&lt;</span><span class="nt">Button</span> <span class="na">id</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;settings-button&#34;</span><span class="p">}</span> <span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">saveRate</span><span class="p">}</span> <span class="na">variant</span><span class="o">=</span><span class="s">&#34;contained&#34;</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">SettingsSuggestIcon</span> <span class="p">/&gt;</span> <span class="nx">save</span> <span class="nx">configuration</span><span class="p">&lt;/</span><span class="nt">Button</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">Box</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">}</span>

    <span class="kr">const</span> <span class="nx">ConfirmDialog</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">&lt;</span><span class="nt">Dialog</span> <span class="na">open</span><span class="o">=</span><span class="p">{</span><span class="kc">true</span><span class="p">}&gt;</span>
            <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>
              <span class="p">{</span><span class="nx">mined</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;Appointment Confirmed&#39;</span><span class="p">}</span>
              <span class="p">{</span><span class="o">!</span><span class="nx">mined</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">showSign</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;Confirming Your Appointment...&#39;</span><span class="p">}</span>
              <span class="p">{</span><span class="o">!</span><span class="nx">mined</span> <span class="o">&amp;&amp;</span> <span class="nx">showSign</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;Please Sign to Confirm&#39;</span><span class="p">}</span>
            <span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="p">{{</span><span class="nx">textAlign</span><span class="o">:</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="nx">padding</span><span class="o">:</span> <span class="s1">&#39;0px 20px 20px 20px&#39;</span><span class="p">}}&gt;</span>
                <span class="p">{</span><span class="nx">mined</span> <span class="o">&amp;&amp;</span> <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
                  <span class="nx">Your</span> <span class="nx">appointment</span> <span class="nx">has</span> <span class="nx">been</span> <span class="nx">confirmed</span> <span class="nx">and</span> <span class="nx">is</span> <span class="nx">on</span> <span class="nx">the</span> <span class="nx">blockchain</span><span class="p">.&lt;</span><span class="nt">br</span> <span class="p">/&gt;&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
                  <span class="p">&lt;</span><span class="nt">a</span> <span class="na">target</span><span class="o">=</span><span class="s">&#34;_blank&#34;</span> <span class="na">href</span><span class="o">=</span><span class="p">{</span><span class="sb">`https://goerli.etherscan.io/tx/</span><span class="si">${</span><span class="nx">transactionHash</span><span class="si">}</span><span class="sb">`</span><span class="p">}&gt;</span><span class="nx">View</span> <span class="nx">on</span> <span class="nx">Etherscan</span><span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
                  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;}</span>
              <span class="p">{</span><span class="o">!</span><span class="nx">mined</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">showSign</span> <span class="o">&amp;&amp;</span> <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Please</span> <span class="nx">wait</span> <span class="k">while</span> <span class="nx">we</span> <span class="nx">confirm</span> <span class="nx">your</span> <span class="nx">appoinment</span> <span class="nx">on</span> <span class="nx">the</span> <span class="nx">blockchain</span><span class="p">....&lt;/</span><span class="nt">p</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;}</span>
              <span class="p">{</span><span class="o">!</span><span class="nx">mined</span> <span class="o">&amp;&amp;</span> <span class="nx">showSign</span> <span class="o">&amp;&amp;</span> <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="nx">Please</span> <span class="nx">sign</span> <span class="nx">the</span> <span class="nx">transaction</span> <span class="nx">to</span> <span class="nx">confirm</span> <span class="nx">your</span> <span class="nx">appointment</span><span class="p">.&lt;/</span><span class="nt">p</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;}</span>
            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="o">=</span><span class="p">{{</span><span class="nx">textAlign</span><span class="o">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="nx">paddingBottom</span><span class="o">:</span> <span class="s1">&#39;30px&#39;</span><span class="p">}}&gt;</span>
            <span class="p">{</span><span class="o">!</span><span class="nx">mined</span> <span class="o">&amp;&amp;</span> <span class="p">&lt;</span><span class="nt">CircularProgress</span> <span class="p">/&gt;}</span>
            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">{</span><span class="nx">mined</span> <span class="o">&amp;&amp;</span> 
            <span class="p">&lt;</span><span class="nt">Button</span> <span class="na">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="p">=&gt;</span> <span class="p">{</span>
                <span class="nx">setShowDialog</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
                <span class="nx">getData</span><span class="p">();</span>
              <span class="p">}</span>
              <span class="p">}&gt;</span><span class="nx">Close</span><span class="p">&lt;/</span><span class="nt">Button</span><span class="p">&gt;}</span>
          <span class="p">&lt;/</span><span class="nt">Dialog</span><span class="p">&gt;</span>
        <span class="p">}</span>

    <span class="k">return</span> <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">{</span><span class="nx">isAdmin</span> <span class="o">&amp;&amp;</span> <span class="p">&lt;</span><span class="nt">Admin</span> <span class="p">/&gt;}</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;calendar&#34;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">Scheduler</span> <span class="na">data</span><span class="o">=</span><span class="p">{</span><span class="nx">appointments</span><span class="p">}&gt;</span>
                <span class="p">&lt;</span><span class="nt">ViewState</span> <span class="p">/&gt;</span>
                <span class="p">&lt;</span><span class="nt">EditingState</span> <span class="na">onCommitChanges</span><span class="o">=</span><span class="p">{</span><span class="nx">saveAppointment</span><span class="p">}</span> <span class="p">/&gt;</span>
                <span class="p">&lt;</span><span class="nt">IntegratedEditing</span> <span class="p">/&gt;</span>
                <span class="p">&lt;</span><span class="nt">WeekView</span> <span class="na">startDayHour</span><span class="o">=</span><span class="p">{</span><span class="mi">9</span><span class="p">}</span> <span class="na">endDayHour</span><span class="o">=</span><span class="p">{</span><span class="mi">19</span><span class="p">}/&gt;</span>
                <span class="p">&lt;</span><span class="nt">Appointments</span> <span class="p">/&gt;</span>
                <span class="p">&lt;</span><span class="nt">AppointmentForm</span> <span class="p">/&gt;</span>
        <span class="p">&lt;/</span><span class="nt">Scheduler</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

        <span class="p">{</span><span class="nx">showDialog</span> <span class="o">&amp;&amp;</span> <span class="p">&lt;</span><span class="nt">ConfirmDialog</span> <span class="p">/&gt;}</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;;</span>
<span class="p">}</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">Calendar</span><span class="p">;</span>
</code></pre></div></article>

        </main><footer id="footer">
    copyright © 2022 parttimelarry
</footer>
</body>
</html>
